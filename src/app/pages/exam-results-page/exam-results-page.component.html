<ngx-smart-modal identifier="examRankingAdd">
  <epsi-exam-ranking-add [exam]="result.exam" [promedio]="result.promedio " *ngIf="result$ | async as result"></epsi-exam-ranking-add>
</ngx-smart-modal>

<ngx-smart-modal identifier="adModal">
  <div class="container">
    <div class="row">

      <div class="col-md-12" *ngIf="promedio < 75">
        <div *ngIf="adPremium$ | async as ad">
          <p>{{ad.value}}</p>
          <a *ngIf="ad.button_text" [href]="ad.href" class="mt-2 btn btn-primary">{{ad.button_text}}</a>
        </div>
      </div>

      <div class="col-md-12" *ngIf="promedio >= 75 && promedio < 85">
        <div *ngIf="adEsencial$ | async as ad">
          <p>{{ad.value}}</p>
          <a *ngIf="ad.button_text" [href]="ad.href" class="mt-2 btn btn-primary">{{ad.button_text}}</a>
        </div>
      </div>

      <div class="col-md-12" *ngIf="promedio >= 85">
        <div *ngIf="adResidente$ | async as ad">
          <p>{{ad.value}}</p>
          <a *ngIf="ad.button_text" [href]="ad.href" class="mt-2 btn btn-primary">{{ad.button_text}}</a>
        </div>
      </div>

    </div>
  </div>
</ngx-smart-modal>

<div class="epsi-exam-results-page container mt-retro" *ngIf="result$ | async as result else loader">
  <div class="row">

    <div class="col-xs-12" [ngClass]="{'col-md-8': result.exam_type == 'demo', 'col-md-12': result.exam_type != 'demo'}">
      <epsi-panel title="Resultados de Exámen" [showContent]="true">

        <div class="container" >
          <div class="row">
            
            <div class="result-header col-md-12">
              <h4 class="c-epsi-primary">Promedio: <strong>{{promedio.toFixed(2)}}/100.00</strong></h4>
              <p>Correctas {{correctas}} de {{questions.length}}</p>
            </div>

            <div class="col-md-12">
              <p>Acompáñanos presencialmente si te es posible , ya que solo abrimos 1 grupo en la CDMX para seguir siempre cuidando la calidad de nuestra atención en su preparación</p>
              <a href="https://enarmzamna.com" class="mt-2 btn btn-primary">VER CURSO PRESENCIAL</a>
            </div>
      
            <div class="result-questions col-md-12" *ngFor="let q of questions; let i = index">
              <small>Pregunta {{i + 1}} de {{questions.length}}</small>
              <div class="flex flex-row flex-start align-center">
                <i class="fa fa-remove" style="color:red" *ngIf="!q.correcta"></i>
                <i class="fa fa-check" style="color:green" *ngIf="q.correcta"></i>
                <span class="ml-2">{{q.raw.text}}</span>
              </div>
              <p>La respuesta correcta era: {{getCorrectaText(q.raw.correcta, q.raw.respuestas)}}</p>
              <p *ngIf="q.raw.feedback">{{q.raw.feedback}}</p>
              <!-- <pre>{{ q | json }}</pre> -->
            </div>

            <div class="col-md-12">
              <ul class="list-group">
                <li class="list-group-item">Promedio por tema</li>
                <li *ngFor="let tag of tags" class="list-group-item">
                  <strong>{{tag.value | number}}</strong>
                  <span class="ml-2">{{tag.name}}</span>
                </li>
              </ul>
            </div>
      
          </div>
        </div>
      
      </epsi-panel>
    </div>

    <div class="col-xs-12 col-md-4" *ngIf="result.exam_type == 'demo'">
      <epsi-panel title="Ranking">
        <ul class="list-group m-4" *ngIf="rankings$ | async as rankings">
          <li class="list-group-item" *ngFor="let r of rankings">
            <strong>{{r.promedio * 10 | number}}</strong> <span class="ml-2">{{r.user.displayName}}</span>
          </li>
        </ul>
      </epsi-panel>
    </div>

  </div>
</div>

<ng-template #loader>
  <epsi-loader></epsi-loader>
</ng-template>