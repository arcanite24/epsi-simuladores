{"version":3,"sources":["../../src/pages/login/login.module.ts","../../src/pages/login/login.ts"],"names":[],"mappings":"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","file":"13.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { LoginPage } from './login';\n\n@NgModule({\n  declarations: [\n    LoginPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(LoginPage),\n  ],\n})\nexport class LoginPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.module.ts","import { BackProvider } from './../../providers/back/back';\nimport { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, LoadingController, ToastController, Platform, ModalController, Toast } from 'ionic-angular';\nimport { Facebook, FacebookLoginResponse } from '@ionic-native/facebook';\nimport { GooglePlus } from '@ionic-native/google-plus';\nimport { AuthService, GoogleLoginProvider, FacebookLoginProvider, SocialUser } from 'angular5-social-login';\nimport { AuthProvider } from '../../providers/auth/auth';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { take } from 'rxjs/operators';\n\n@IonicPage()\n@Component({\n  selector: 'page-login',\n  templateUrl: 'login.html',\n})\nexport class LoginPage {\n\n  public showAdmin: boolean = false\n  public loginData = {email: '', password: ''}\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private back: BackProvider,\n    private load: LoadingController,\n    private fb: Facebook,\n    private toast: ToastController,\n    private google: GooglePlus,\n    private platform: Platform,\n    //private auth: AuthService,\n    private auth: AuthProvider,\n    private modal: ModalController,\n    private afAuth: AngularFireAuth\n    ) {\n  }\n\n  /* async loginFacebook() {\n\n    const l = this.load.create({content: 'Iniciando sesión con Facebook...'})\n    l.present()\n\n    if (this.platform.is('cordova')) {\n\n      try {\n        const res: FacebookLoginResponse = await this.fb.login(['public_profile', 'email'])\n        this.back.facebookApp(res.authResponse.accessToken).subscribe(data => {\n          if (data.err) return this.toast.create({message: data.err, duration: 2000}).present()\n          localStorage.setItem('user', JSON.stringify(data.user))\n          localStorage.setItem('token', data.token)\n          localStorage.setItem('uid', data.user.id)\n          //this.back.saveFcmToken(data.user.id, localStorage.getItem('fcm_token')).then(data => console.log(data)).catch(err => this.toast.create({message: 'No se pudo registrar tu dispositivo...', duration: 2000}).present())\n          this.navCtrl.setRoot('HomePage')\n          l.dismiss()\n        }, err => {\n          this.toast.create({message: 'No pudimos inicar sesión con tu Facebook', duration: 2000}).present()  \n          l.dismiss()\n        })\n      } catch (error) {\n        l.dismiss()\n        this.toast.create({message: 'No pudimos inicar sesión con tu Facebook', duration: 2000}).present()\n      }\n\n    } else {\n\n      this.auth.signIn(FacebookLoginProvider.PROVIDER_ID)\n        .then((data: SocialUser) => {\n          this.handleSocial(data)\n          l.dismiss()\n        })\n        .catch(err => {\n          this.toast.create({message: 'Ocurrío un error al iniciar sesión con Facebook...', duration: 2000}).present()\n          l.dismiss()\n        })\n\n    }\n\n  }\n\n  async loginGoogle() {\n\n    const l = this.load.create({content: 'Iniciando sesión con Google...'})\n    l.present()\n\n    if (this.platform.is('cordova')) {\n\n      try {\n        const res = await this.google.login({})\n        this.back.googleApp(res).subscribe(data => {\n          if (data.err) return this.toast.create({message: data.err, duration: 2000}).present()\n          localStorage.setItem('user', JSON.stringify(data.user))\n          localStorage.setItem('token', data.token)\n          localStorage.setItem('uid', data.user.id)\n          //this.back.saveFcmToken(data.user.id, localStorage.getItem('fcm_token')).then(data => console.log(data)).catch(err => this.toast.create({message: 'No se pudo registrar tu dispositivo...', duration: 2000}).present())\n          this.navCtrl.setRoot('HomePage')\n          l.dismiss()\n        }, err => {\n          this.toast.create({message: 'No pudimos inicar sesión con tu cuenta de Google', duration: 2000}).present()  \n          l.dismiss()\n        })\n      } catch (error) {\n        this.toast.create({message: 'No pudimos inicar sesión con tu cuenta de Google', duration: 2000}).present()\n        l.dismiss()\n      }\n\n    } else {\n\n      this.auth.signIn(GoogleLoginProvider.PROVIDER_ID)\n        .then(data => {\n          this.handleSocial(data)\n          l.dismiss()\n        })\n        .catch(err => {\n          this.toast.create({message: 'Ocurrío un error al iniciar sesión con Google...', duration: 2000}).present()\n          l.dismiss()\n        })\n\n    }\n\n  } */\n\n  ionViewDidLoad() {\n    this.auth.user$.subscribe(user => {\n      if (user) this.navCtrl.setRoot('HomePage')\n    })\n  }\n  \n  handleSocial(data: any) {\n\n    this.back.socialAuthWeb(data).subscribe(authInfo => {\n\n      if (authInfo.err) return this.toast.create({message: authInfo.err, duration: 2000}).present()\n\n      localStorage.setItem('uid', authInfo.user.id)\n      localStorage.setItem('user', JSON.stringify(authInfo.user))\n      localStorage.setItem('token', authInfo.token)\n      this.navCtrl.setRoot('HomePage')      \n      \n    }, err => {\n      this.toast.create({message: 'Ocurrió un error al iniciar sesión...', duration: 2000}).present()\n    })\n\n  }\n\n  async login() {\n\n    const l = this.load.create({content: 'Iniciando Sesión...'})\n    l.present()\n\n    try {\n      const user = await this.afAuth.auth.signInWithEmailAndPassword(this.loginData.email, this.loginData.password)\n      const _user = await this.afAuth.user.pipe(take(1)).toPromise()\n      this.auth.setUser({\n        email: _user.email,\n        displayName: _user.displayName,\n        photoURL: _user.photoURL,\n        uid: _user.uid,\n      })\n      this.navCtrl.setRoot('HomePage')\n      this.toast.create({message: `Bienvenido ${user.user.displayName}`, duration: 2000}).present()\n      l.dismiss()\n    } catch (error) {\n      this.toast.create({message: error.message, duration: 2000}).present()\n      l.dismiss()\n    }\n\n    /* this.back.login(this.loginData.email, this.loginData.password).subscribe(data => {\n\n      if (data.err) {\n        this.toast.create({message: data.err, duration: 2000}).present()\n        l.dismiss()\n      } else {\n        localStorage.setItem('uid', data.user.id)\n        localStorage.setItem('user', JSON.stringify(data.user))\n        localStorage.setItem('token', data.token)\n        //this.back.saveFcmToken(data.user.id, localStorage.getItem('fcm_token')).then(data => console.log(data)).catch(err => this.toast.create({message: 'No se pudo registrar tu dispositivo...', duration: 2000}).present())\n        this.navCtrl.setRoot('HomePage')\n        l.dismiss()\n      }\n\n    }, err => {\n      l.dismiss()\n      this.toast.create({message: 'Ocurrió un error al iniciar sesión...', duration: 2000}).present()\n    }) */\n    \n  }\n\n  openHowto() {\n    this.modal.create('HowtoPage').present()    \n  }\n\n  async loginGoogleFire() {\n    try {\n      const user = await this.auth.loginGoogle()\n      this.toast.create({message: `Bienvenido de nuevo ${user.displayName}`, duration: 2000}).present()\n      this.navCtrl.setRoot('HomePage')\n    } catch (error) {\n      console.log(error)\n      this.toast.create({message: 'Algo ocurrió al iniciar sesión con tu cuenta de Google. Contacta con un administrador.', duration: 2000}).present()\n    }\n  }\n\n  async loginFacebookFire() {\n    try {\n      const user = await this.auth.loginFacebook()\n      this.toast.create({message: `Bienvenido de nuevo ${user.displayName}`, duration: 2000}).present()\n      this.navCtrl.setRoot('HomePage')\n    } catch (error) {\n      console.log(error)\n      this.toast.create({message: 'Algo ocurrió al iniciar sesión con tu cuenta de Facebook. Contacta con un administrador.', duration: 2000}).present()\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.ts"],"sourceRoot":""}