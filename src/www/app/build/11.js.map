{"version":3,"sources":["../../src/pages/top-users/top-users.module.ts","../../src/pages/top-users/top-users.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACO;AACL;AAU3C,IAAa,kBAAkB,GAA/B,MAAa,kBAAkB;CAAG;AAArB,kBAAkB;IAR9B,+DAAQ,CAAC;QACR,YAAY,EAAE;YACZ,gEAAY;SACb;QACD,OAAO,EAAE;YACP,sEAAe,CAAC,QAAQ,CAAC,gEAAY,CAAC;SACvC;KACF,CAAC;GACW,kBAAkB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZmB;AAGO;AACF;AACnB;AACmB;AACG;AAO1D,IAAa,YAAY,GAAzB,MAAa,YAAY;IAIvB,YACS,IAAkB,EACjB,GAAqB,EACrB,KAAoB;QAFrB,SAAI,GAAJ,IAAI,CAAc;QACjB,QAAG,GAAH,GAAG,CAAkB;QACrB,UAAK,GAAL,KAAK,CAAe;IAC1B,CAAC;IAEL,QAAQ;QAEN,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,CAAO,oEAAW,CAAC,IAAI,EAAE,GAAG,CAAC,EAAE,CAAC,GAAG;aACjE,KAAK,CAAC,UAAU,EAAE,GAAG,EAAE,CAAC,CAAC;aACzB,OAAO,CAAC,UAAU,EAAE,MAAM,CAAC;aAC3B,KAAK,CAAC,CAAC,CAAC,CAAC;aACT,YAAY,EAAE;QAEjB,IAAI,CAAC,WAAW,EAAE;IAEpB,CAAC;IAEK,WAAW;;YAEf,MAAM,KAAK,GAAW,MAAM,IAAI,CAAC,GAAG,CAAC,UAAU,CAAO,oEAAW,CAAC,IAAI,CAAC,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,4DAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE;YAEhH,KAAK,MAAM,IAAI,IAAI,KAAK,EAAE;gBACxB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,GAAG,CAAC;gBAC9D,MAAM,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,oEAAW,CAAC,IAAI,IAAI,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,MAAM,CAAC,EAAC,QAAQ,EAAE,QAAQ,EAAC,CAAC;aACnF;QAEH,CAAC;KAAA;CAEF;AAjCY,YAAY;IAJxB,gEAAS,CAAC;QACT,QAAQ,EAAE,gBAAgB;OACG;KAC9B,CAAC;kFAM2B;QACZ,+EAAgB;QACd,SAAa;AA0B/B;SAjCY,YAAY,gB","file":"11.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TopUsersPage } from './top-users';\n\n@NgModule({\n  declarations: [\n    TopUsersPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(TopUsersPage),\n  ],\n})\nexport class TopUsersPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/top-users/top-users.module.ts","import { Component, OnInit } from '@angular/core';\nimport { IonicPage } from 'ionic-angular';\nimport {Observable} from \"rxjs\";\nimport {AngularFirestore} from \"@angular/fire/firestore\";\nimport {Collections, User} from \"../../app/app.models\";\nimport {take} from \"rxjs/operators\";\nimport {AuthProvider} from \"../../providers/auth/auth\";\nimport {StatsProvider} from \"../../providers/stats/stats\";\n\n@IonicPage()\n@Component({\n  selector: 'page-top-users',\n  templateUrl: 'top-users.html',\n})\nexport class TopUsersPage implements OnInit {\n\n  public users$: Observable<User[]>\n\n  constructor(\n    public auth: AuthProvider,\n    private afs: AngularFirestore,\n    private stats: StatsProvider,\n  ) { }\n\n  ngOnInit() {\n\n    this.users$ = this.afs.collection<User>(Collections.USER, ref => ref\n      .where('promedio', '>', 0)\n      .orderBy('promedio', 'desc')\n      .limit(5))\n      .valueChanges()\n\n    this.reloadUsers()\n\n  }\n\n  async reloadUsers() {\n\n    const users: User[] = await this.afs.collection<User>(Collections.USER).valueChanges().pipe(take(1)).toPromise()\n\n    for (const user of users) {\n      const promedio = await this.stats.computeUserAverage(user.uid)\n      await this.afs.doc(`${Collections.USER}/${user.uid}`).update({promedio: promedio})\n    }\n\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/top-users/top-users.ts"],"sourceRoot":""}