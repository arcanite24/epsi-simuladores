{"version":3,"sources":["../../src/pages/simuladores/simuladores.module.ts","../../src/pages/simuladores/simuladores.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACO;AACA;AAUhD,IAAa,qBAAqB,GAAlC;CAAqC;AAAxB,qBAAqB;IARjC,+DAAQ,CAAC;QACR,YAAY,EAAE;YACZ,qEAAe;SAChB;QACD,OAAO,EAAE;YACP,sEAAe,CAAC,QAAQ,CAAC,qEAAe,CAAC;SAC1C;KACF,CAAC;GACW,qBAAqB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZQ;AACe;AAEC;AACgB;AAC/C;AACU;AACoB;AAOzD,IAAa,eAAe,GAA5B;IAQE,YACS,OAAsB,EACtB,SAAoB,EACnB,GAAqB,EACrB,IAAkB;QAHnB,YAAO,GAAP,OAAO,CAAe;QACtB,cAAS,GAAT,SAAS,CAAW;QACnB,QAAG,GAAH,GAAG,CAAkB;QACrB,SAAI,GAAJ,IAAI,CAAc;QATrB,cAAS,GAAY,KAAK;IAWjC,CAAC;IAED,cAAc;QACZ,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE;YAC/B,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS;gBAAE,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,cAAc,IAAI,EAAE,CAAC;YACxE,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;gBACxB,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;aACtB;QACH,CAAC,CAAC;IACJ,CAAC;IAED,SAAS,CAAC,IAAU;QAClB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,CAAO,oEAAW,CAAC,IAAI,EAAE,GAAG,CAAC,EAAE,CAAC,GAAG;aACjE,KAAK,CAAC,MAAM,EAAE,IAAI,EAAE,kEAAS,CAAC,SAAS,CAAC;aACxC,KAAK,CAAC,MAAM,EAAE,IAAI,EAAE,8CAAM,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,WAAW,EAAE,CAAC,CAAC;aACzD,YAAY,EAAE;aACd,IAAI,CACH,2DAAG,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,CAClE,CAAC;IACN,CAAC;IAEO,UAAU,CAAC,IAAU,EAAE,IAAU;QACvC,IAAI,IAAI,CAAC,aAAa,IAAI,CAAC,IAAI,CAAC,YAAY;YAAE,OAAO,IAAI,CAAC;QAC1D,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY;YAAE,OAAO,IAAI,CAAC;QACxD,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,YAAY;YAAE,OAAO,IAAI,CAAC;QACrD,OAAO,KAAK,CAAC;IACf,CAAC;CAEF;AA1CY,eAAe;IAJ3B,gEAAS,CAAC;QACT,QAAQ,EAAE,kBAAkB;OACG;KAChC,CAAC;yEAU+B;QACX,wEAAS;QACd,4EAAgB;QACf,YAAY;AA8B7B;SA1CY,eAAe,e","file":"20.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { SimuladoresPage } from './simuladores';\n\n@NgModule({\n  declarations: [\n    SimuladoresPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(SimuladoresPage),\n  ],\n})\nexport class SimuladoresPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/simuladores/simuladores.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { Observable } from 'rxjs';\nimport { AngularFirestore } from 'angularfire2/firestore';\nimport { Exam, Collections, ExamTypes, User } from '../../app/app.models';\nimport moment from 'moment'\nimport { map } from 'rxjs/operators';\nimport { AuthProvider } from '../../providers/auth/auth';\n\n@IonicPage()\n@Component({\n  selector: 'page-simuladores',\n  templateUrl: 'simuladores.html',\n})\nexport class SimuladoresPage {\n\n  public exams$: Observable<any[]>\n  public isOffline: boolean = false\n  public downloadList: any[]\n\n  public completed: any;\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private afs: AngularFirestore,\n    private auth: AuthProvider,\n  ) {\n  }\n\n  ionViewDidLoad() {\n    this.auth.user$.subscribe(user => {\n      if (user && !this.completed) this.completed = user.completedExams || [];\n      if (user && !this.exams$) {\n        this.loadExams(user);\n      }\n    })\n  }\n\n  loadExams(user: User) {\n    this.exams$ = this.afs.collection<Exam>(Collections.EXAM, ref => ref\n      .where('type', '==', ExamTypes.SIMULADOR)\n      .where('date', '<=', moment().endOf('day').toISOString()))\n      .valueChanges()\n      .pipe(\n        map(list => list.reverse().filter(e => this.isUnlocked(user, e))),\n      );\n  }\n\n  private isUnlocked(user: User, exam: Exam) {\n    if (user.isPremium2019 && !exam.isPresencial) return true;\n    if (user.isPresencial && exam.isPresencial) return true;\n    if (user.is3602019 && exam.isPresencial) return true;\n    return false;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/simuladores/simuladores.ts"],"sourceRoot":""}