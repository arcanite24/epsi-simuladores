{"version":3,"sources":["../../src/pages/examen-detail/examen-detail.module.ts","../../src/pages/examen-detail/examen-detail.ts"],"names":[],"mappings":"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","file":"33.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ExamenDetailPage } from './examen-detail';\n\n@NgModule({\n  declarations: [\n    ExamenDetailPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ExamenDetailPage),\n  ],\n})\nexport class ExamenDetailPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/examen-detail/examen-detail.module.ts","import { BackProvider } from './../../providers/back/back';\nimport { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ToastController, ViewController, ModalController } from 'ionic-angular';\nimport { Observable } from 'rxjs';\nimport { Exam, Collections } from '../../app/app.models';\nimport { AngularFirestore } from 'angularfire2/firestore';\nimport { tap } from 'rxjs/operators';\n\n@IonicPage({segment: 'examen/:type/:id'})\n@Component({\n  selector: 'page-examen-detail',\n  templateUrl: 'examen-detail.html',\n})\nexport class ExamenDetailPage {\n  \n  public id: string = this.navParams.get('id')\n  public type: string = this.navParams.get('type')\n  private isOffline: boolean = this.navParams.get('offline')\n\n  public exam$: Observable<Exam>\n\n  public test: any\n  public l: boolean = false\n\n  public index: number = 0\n\n  private cacheKey: string = `examen-download-${this.type}-${this.id}`\n  private cacheList: any[] = []\n  public testCache: any = !!localStorage.getItem(this.cacheKey)\n  public s: any = this.navParams.get('s') ? JSON.parse(this.navParams.get('s')) : null\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private back: BackProvider,\n    private toast: ToastController,\n    public viewCtrl: ViewController,\n    private modal: ModalController,\n    private afs: AngularFirestore\n  ) {\n  }\n\n  ionViewDidLoad() {\n\n    this.exam$ = this.afs.collection(Collections.EXAM).doc<Exam>(this.id)\n      .valueChanges()\n      .pipe(\n        tap(data => {\n          this.test = {name: data.name, preguntas: data.questions}\n        })\n      )\n\n    /* if (this.s) return this.test = this.s.test\n    \n    this.back.getClase(this.id, this.type).subscribe(data => {\n      if (!data.preguntas || data.preguntas.length <= 0) {\n        this.toast.create({message: 'No existe un exámen para ésta clase...', duration: 2000}).present()\n        this.viewCtrl.dismiss()\n      } else {\n        this.test = {name: data.name, preguntas: data.preguntas}\n        const cache = JSON.parse(localStorage.getItem(`examen-cache-${this.type}-${this.id}`))\n        if (cache) {\n          this.index = cache.index\n          this.test.preguntas[this.index].s = cache.selected\n        }\n      }\n    }, err => {\n      this.toast.create({message: 'No se pudo cargar el exámen...', duration: 2000}).present()\n    })\n\n    this.loadCacheList() */\n\n  }\n\n  enviarResultados() {\n\n    this.l = true\n\n    let resultados = {}\n    this.test.preguntas.forEach(p => {\n      resultados[p.id] = {\n        selected: p.s,\n        pregunta: p\n      }\n    })\n\n    if (this.isOffline) {\n\n      const list = JSON.parse(localStorage.getItem('offline-results'))\n      const offlineResults = list ? list : []\n\n      offlineResults.push(resultados)\n      localStorage.setItem('offline-results', JSON.stringify(offlineResults))\n\n      this.toast.create({message: 'Tus resultados se guardaron correctamente.', duration: 2000}).present()\n      this.viewCtrl.dismiss(resultados)\n\n    } else {\n\n      this.back.addResultado(this.type, this.back.uid, this.id, resultados).subscribe(data => {\n        this.toast.create({message: 'Resultados registrados correctamente.', duration: 2000}).present()\n        this.viewCtrl.dismiss(data)\n      }, err => {\n        this.l = false\n        this.toast.create({message: 'No se pudieron agregar tus resultados...', duration: 2000}).present()\n      })\n\n    }\n\n  }\n\n  openResultados(id, type) {\n    const m = this.modal.create('ResultadosExamenPage', {type, id})\n    m.present()\n  }\n\n  next() {\n    if (this.index == this.test.preguntas.length - 1) {\n      this.enviarResultados()\n    } else {\n      this.saveCache()\n      this.index++\n    }\n  }\n\n  saveCache() {\n\n    let resultados = {}\n    let selected = this.test.preguntas[this.index].s\n    this.test.preguntas.forEach(p => {\n      resultados[p.id] = {\n        selected: p.s,\n        pregunta: p\n      }\n    })\n\n    localStorage.setItem(`examen-cache-${this.type}-${this.id}`, JSON.stringify({\n      index: this.index,\n      resultados,\n      selected\n    }))\n\n    localStorage.setItem(`examen-selected-${this.type}-${this.id}-${this.index}`, this.test.preguntas[this.index].s)\n\n  }\n\n  prev() {\n\n    this.index--\n\n    const selected = localStorage.getItem(`examen-selected-${this.type}-${this.id}-${this.index}`)\n    if (selected) this.test.preguntas[this.index].s = selected\n\n  }\n\n  openAvance() {\n\n    const m = this.modal.create('AvanceExamenPage', {preguntas: this.test.preguntas})\n    m.present()\n\n    m.onDidDismiss(index => {\n      if (!index) return\n      this.index = index\n    })\n\n  }\n\n  loadCacheList() {\n    const list = JSON.parse(localStorage.getItem('zamnademy-cache-list'))\n    this.cacheList = list ? list : []\n  }\n\n  downloadExamen() {\n    const cache = {\n      id: this.id,\n      type: this.type,\n      test: this.test\n    }\n    this.cacheList.push({\n      id: cache.id,\n      name: cache.test.name,\n      type: cache.type\n    })\n    localStorage.setItem('zamnademy-cache-list', JSON.stringify(this.cacheList))\n    localStorage.setItem(this.cacheKey, JSON.stringify(cache))\n    this.testCache = cache\n    this.toast.create({message: 'Exámen descargado correctamente.', duration: 2000}).present()\n  }\n\n  removeExamen() {\n    localStorage.removeItem(this.cacheKey)\n    this.cacheList = this.cacheList.filter(test => test.id != this.id)\n    localStorage.setItem('zamnademy-cache-list', JSON.stringify(this.cacheList)) \n    this.testCache = null\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/examen-detail/examen-detail.ts"],"sourceRoot":""}